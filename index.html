
<html>

    <head>

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />
        
        <link href="styles.css" rel="stylesheet">
        
        <title>R4G</title>
		  
		<!-- scripts for blockly code -->
		<script src="blockly_compressed.js"></script>
        <script src="blocks_compressed.js"></script>
        <script src="js/en.js"></script>
        <script src="javascript_compressed.js"></script>
		
		<!-- something here seems to disturb bluetooth connection
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
		-->	
        
    </head>
	
    <!-- header -->
	<div class="container-fluid zimd_header text-center">
     	<h3>R4G</h3>
      	<img src="media/r4g.PNG" class="img-circle" style="float:center;width:100px;height:100px;">
      	<h3>Robo4Girls</h3>
	</div>

	<!-- body -->
    <body ontouchstart="" id='i2'><!-- ontouchstart="" enables low-delay CSS transitions. -->
  
		<!-- Bluetooth communication -->
		<!--<div class="container-fluid bluetooth "> -->
		  <h3>Connect to Bluetooth</h3>

			<button id="connect" type="button">Connect</button>
			<button id="disconnect" type="button">Disconnect</button>

			<!-- input file and button for sending data -->
			<input id="input" type="text"/>
			<button id="sendData" type="button">Send</button>

			<!-- terminal, text color changes: debug=grey, input=blue, output=red -->
			<div class="term" id="terminal"></div>
		
			<!-- script for bluetooth communication -->
			<script type="text/javascript" src="ble3.js"></script>

	 	<!--</div> -->
		
    	<!-- R4G programming environment -->
   		<!--<div class="container-fluid workspace text-center">-->
      		<h3>Start programmimng</h3>

			<script>
			    function handlePlay(event){
    				Blockly.JavaScript.addReservedWords('code');
    				var code = Blockly.JavaScript.workspaceToCode(Blockly.getMainWorkspace());
    				
					
            			var splitCode = code.split(" ");
            			//saves every code till to the : in an index of the splitCode Array
            			for(i = 0; i < splitCode.length-1; i++){
              			   try {
                  			console.log("function handle Play:" + splitCode[i]);
                  			// Eval can be dangerous. For more controlled execution, check
    				    	// https://github.com/NeilFraser/JS-Interpreter.
							eval(sendData(splitCode[i]));
							//sleep(3000);
				    } catch (error) {
					console.log(error);
				    }
            			}
			    }
			</script>
			
			<!-- play button starts program -->
			<button onclick="handlePlay()" type="button">Play</button>
			

			<!-- blockly programming window -->
			<div id="blocklyDiv" style="position: absolute; width: 70%;"></div>
        
			<!-- R4G blocks design --> 
			<xml xmlns="http://www.w3.org/1999/xhtml" id="toolbox" style="display: none;">
				<!-- Category Movements -->
				<category name="Bewegungen" color="210">
					<block type="forward">
						<field name="forward_duration">0.1</field>
					</block>
					<block type="back">
						<field name="back_duration">0.1</field>
					</block>
					
          			<block type="repetition">
            			<field name="repetition">0.1</field>
           			</block>
        </category>
        
			</xml>
			
    		<!-- Making Toolbox visible in Web-browser -->
			<script>
		  		var workspace = Blockly.inject('blocklyDiv',{
					media: 'media/',
					toolbox:document.getElementById('toolbox')
				})
			</script>
			
			
			<!-- Blockly scripts -->
			<script src="scripts/R4Gblocks.js"></script>
			
		<!--</div>	 container workspace -->
		

    </body>

</html>
